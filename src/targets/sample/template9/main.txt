

@@------- MAIN ENTRY POINT -------

@@BEGIN-TEMPLATE NAME="MAIN"
@@ASSERT IS-ROOT(PARAM-ROOT)
@@OPEN-OUTPUT-FILE FILENAME="output.h"
#include <simple_lib.h>

// structures

  @@INCLUDE TEMPLATE="MAP_3" PARAM-ROOT=PARAM-ROOT
  @@-INCLUDE TEMPLATE="SMART-DECLARING" PARAM-ROOT=PARAM-ROOT
    
// serialization

  @@INCLUDE TEMPLATE="ROOT_3" PARAM-ROOT=PARAM-ROOT
  
// deserialization

  @@INCLUDE TEMPLATE="ROOT_4" PARAM-ROOT=PARAM-ROOT
  
// printing

  @@INCLUDE TEMPLATE="ROOT_5" PARAM-ROOT=PARAM-ROOT
@@CLOSE-OUTPUT-FILE
@@END-TEMPLATE NAME="MAIN"


@@------- SMART DECLARING -------

@@BEGIN-TEMPLATE NAME="SMART-DECLARING"
@@ASSERT IS-ROOT(PARAM-ROOT)
@@-LET LOCAL-PUB-STRUCTS=PUBLISHABLE-STRUCTS()

  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-STRUCTS()
     @@INCLUDE TEMPLATE="MAP-S-CALLING" PARAM-STRUCT=LOCAL-PS-IT
  @@FOR-EACH END

  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-DISCRIMINATED-UNIONS()
     @@INCLUDE TEMPLATE="MAP-DU" PARAM-STRUCT=LOCAL-PS-IT
  @@FOR-EACH END

@@END-TEMPLATE NAME="SMART-DECLARING"



@@------- MAPPING -------

@@BEGIN-TEMPLATE NAME="MAP_3"
@@ASSERT IS-ROOT(PARAM-ROOT)
@@-LET LOCAL-PUB-STRUCTS=PUBLISHABLE-STRUCTS()

  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-STRUCTS()
     @@INCLUDE TEMPLATE="MAP-S-CALLING" PARAM-STRUCT=LOCAL-PS-IT
  @@FOR-EACH END

  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-DISCRIMINATED-UNIONS()
     @@INCLUDE TEMPLATE="MAP-DU" PARAM-STRUCT=LOCAL-PS-IT
  @@FOR-EACH END

@@END-TEMPLATE NAME="MAP_3"



@@------- SERIALIZATION -------

@@BEGIN-TEMPLATE NAME="ROOT_3"
@@ASSERT IS-ROOT(PARAM-ROOT)
  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-STRUCTS()
     @@INCLUDE TEMPLATE="SERIALIZE-S-CALLING-ALT" PARAM-STRUCT=LOCAL-PS-IT
  @@FOR-EACH END

  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-DISCRIMINATED-UNIONS()
     @@INCLUDE TEMPLATE="SERIALIZE-DU" PARAM-DU=LOCAL-PS-IT
  @@FOR-EACH END

@@END-TEMPLATE NAME="ROOT_3"



@@------- DESERIALIZATION -------

@@BEGIN-TEMPLATE NAME="ROOT_4"
@@ASSERT IS-ROOT(PARAM-ROOT)
  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-STRUCTS()
     @@INCLUDE TEMPLATE="DESERIALIZE-S-CALLING-ALT" PARAM-STRUCT=LOCAL-PS-IT
  @@FOR-EACH END

  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-DISCRIMINATED-UNIONS()
     @@INCLUDE TEMPLATE="DESERIALIZE-DU" PARAM-DU=LOCAL-PS-IT
  @@FOR-EACH END
  
@@END-TEMPLATE NAME="ROOT_4"



@@------- PRINTING -------

@@BEGIN-TEMPLATE NAME="ROOT_5"
@@ASSERT IS-ROOT(PARAM-ROOT)
  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-STRUCTS()
     @@INCLUDE TEMPLATE="PRINT-S" PARAM-STRUCT=LOCAL-PS-IT
  @@FOR-EACH END

  @@FOR-EACH LOCAL-PS-IT IN PARAM-ROOT.PUBLISHABLE-DISCRIMINATED-UNIONS()
     @@INCLUDE TEMPLATE="PRINT-DU" PARAM-DU=LOCAL-PS-IT
  @@FOR-EACH END
  
@@END-TEMPLATE NAME="ROOT_5"
